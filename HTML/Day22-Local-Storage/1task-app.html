<!DOCTYPE html>
<html>
<head>
    <title> Task Manager </title>
</head>
<body>
    <div id="root">
        <h2>Task Box -<span id="count"></span></h2>
        <ul id="tasks">
        </ul>
        <form id="myForm">
            <label>
                Name
                <input type="text" id="name" />
            </label>
            <input type="submit" />
        </form>

        <button id="resetBtn">Reset</button>
    </div>
    <script>
        let tasks
        if(localStorage.getItem('tasksDB')) { // check if the tasks is there in the local storage. if yes then parse the value and set it to the tasks variable
            tasks = JSON.parse(localStorage.getItem('tasksDB'))
        } else { // set the value of tasks to be empty array
            tasks = []
        }

        const myFormHandle = document.getElementById('myForm')
        const nameHandle = document.getElementById('name')
        const tasksHandle = document.getElementById('tasks')
        const resetBtnHandle = document.getElementById('resetBtn')
        const countHandle=document.getElementById('count')

        function makeLi(task) {
            const li = document.createElement('li')
            li.textContent = task.title
            const check=document.createElement('input')
            check.setAttribute('type','checkbox')
            li.appendChild(check)
            tasksHandle.appendChild(li)
            check.addEventListener('change',function()
            {
                if(check.checked)
                {
                    const dele=document.createElement('del')
                    dele.textContent=li.innerHTML.split('<')[0]
                    console.log(dele)
                    tasksHandle.replaceChild(dele,li)
                }
            })
   
        }

        tasks.forEach(function(task){
            makeLi(task)
        })

        countHandle.innerHTML=tasks.length

        myFormHandle.addEventListener('submit', function (e) {
            e.preventDefault()
            const name = nameHandle.value 
            const task = { title: name }
            makeLi(task)
            tasks.push(task)
            countHandle.innerHTML=tasks.length
            localStorage.setItem('tasksDB', JSON.stringify(tasks))
            console.log(localStorage.getItem('tasksDB'))
            myFormHandle.reset()
        })

        resetBtnHandle.addEventListener('click', function(){
            tasksHandle.innerHTML = ''
            tasks=[]
            countHandle.innerHTML=tasks.length
            localStorage.setItem('tasksDB', JSON.stringify([]))
        })
    </script>
</body>
</html>